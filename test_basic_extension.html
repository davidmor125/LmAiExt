<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>×‘×“×™×§×ª ×ª×•×¡×£ ×‘×¡×™×¡×™×ª - Better Me</title>
    <style>
        body {
            font-family: 'Segoe UI', sans-serif;
            padding: 30px;
            background: #f8f9fa;
            color: #2c5282;
        }
        .container {
            max-width: 600px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 15px;
            border: 2px solid #2c5282;
        }
        .test-text {
            background: #fff3cd;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            border: 2px solid #2c5282;
            font-size: 16px;
            line-height: 1.6;
        }
        .instructions {
            background: #e8f4fd;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            border: 2px solid #2c5282;
        }
        .status {
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            font-weight: bold;
        }
        .success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .error { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        .warning { background: #fff3cd; color: #856404; border: 1px solid #ffeaa7; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ” ×‘×“×™×§×ª ×ª×•×¡×£ Better Me</h1>
        
        <div class="instructions">
            <h3>ğŸ“‹ ×”×•×¨××•×ª:</h3>
            <ol>
                <li>×•×•×“× ×©×”×ª×•×¡×£ Better Me ××•×ª×§×Ÿ ×•×¤×¢×™×œ ×‘×“×¤×“×¤×Ÿ</li>
                <li>×¤×ª×— ××ª Developer Tools (F12) ×•×¢×‘×•×¨ ×œ×˜××‘ Console</li>
                <li>×‘×—×¨ ××ª ×”×˜×§×¡×˜ ×œ××˜×”</li>
                <li>×××•×¨ ×œ×¨××•×ª ×ª×¤×¨×™×˜ ×¦×£ ×¢× ×›×¤×ª×•×¨ "×¡×›× ×˜×§×¡×˜ ××¡×•××Ÿ"</li>
                <li>×œ×—×¥ ×¢×œ ×”×›×¤×ª×•×¨ ×•×‘×“×•×§ ×× × ×¤×ª×— ×“×™××œ×•×’</li>
            </ol>
        </div>

        <div class="test-text">
            ×–×”×• ×˜×§×¡×˜ ×œ×‘×“×™×§×”. ×‘×—×¨ ××ª ×”×˜×§×¡×˜ ×”×–×” ×›×“×™ ×œ×‘×“×•×§ ×× ×”×ª×•×¡×£ ×¤×•×¢×œ ×›×¨××•×™. ×”×˜×§×¡×˜ ×”×–×” ×××•×¨ ×œ×”×¦×™×’ ×ª×¤×¨×™×˜ ×¦×£ ×›×©××¡×× ×™× ××•×ª×•. ×× ×”×ª×•×¡×£ ×¢×•×‘×“, ×××•×¨×” ×œ×”×•×¤×™×¢ ××¤×©×¨×•×ª ×œ×¡×›× ××ª ×”×˜×§×¡×˜ ×”××¡×•××Ÿ.
        </div>

        <div id="status-container">
            <h3>ğŸ“Š ×¡×˜×˜×•×¡ ×‘×“×™×§×•×ª:</h3>
            <div id="extension-status" class="status warning">×‘×•×“×§ ×× ×”×ª×•×¡×£ × ×˜×¢×Ÿ...</div>
            <div id="menu-status" class="status warning">×‘×•×“×§ ×ª×¤×¨×™×˜ ×¦×£...</div>
            <div id="dialog-status" class="status warning">×‘×•×“×§ ×“×™××œ×•×’ ×¡×™×›×•×...</div>
        </div>        <div class="instructions">
            <h3>ğŸ§ª ×‘×“×™×§×•×ª ×™×“× ×™×•×ª:</h3>
            <button onclick="forceTestDialog()" style="background: #2c5282; color: white; border: none; padding: 12px 20px; border-radius: 8px; cursor: pointer; margin: 10px 5px; font-size: 14px;">
                ğŸš€ ×¤×ª×— ×“×™××œ×•×’ ×‘×›×•×—
            </button>
            <button onclick="checkExtensionStatus()" style="background: #28a745; color: white; border: none; padding: 12px 20px; border-radius: 8px; cursor: pointer; margin: 10px 5px; font-size: 14px;">
                ğŸ” ×‘×“×•×§ ×¡×˜×˜×•×¡ ×ª×•×¡×£
            </button>
            <button onclick="clearLogs()" style="background: #dc3545; color: white; border: none; padding: 12px 20px; border-radius: 8px; cursor: pointer; margin: 10px 5px; font-size: 14px;">
                ğŸ—‘ï¸ × ×§×” ×œ×•×’×™×
            </button>
        </div>
            <div id="debug-info" style="font-family: monospace; font-size: 12px; background: #f8f9fa; padding: 10px; border-radius: 5px;">
                ×˜×•×¢×Ÿ...
            </div>
        </div>
    </div>

    <script>
        function updateStatus(elementId, status, message) {
            const element = document.getElementById(elementId);
            element.className = `status ${status}`;
            element.textContent = message;
        }

        function updateDebugInfo() {
            const debugDiv = document.getElementById('debug-info');
            let info = '';
            
            info += `Document Ready State: ${document.readyState}\n`;
            info += `User Agent: ${navigator.userAgent}\n`;
            info += `Page URL: ${window.location.href}\n`;
            info += `Content Script Loaded: ${typeof chrome !== 'undefined' && chrome.runtime ? 'Yes' : 'No'}\n`;
            
            // Check for extension functions
            const functions = [
                'initFloatingMenu',
                'createFloatingMenu', 
                'handleFloatingMenuSummary',
                'openSummaryDialog'
            ];
            
            info += '\nExtension Functions:\n';
            functions.forEach(func => {
                info += `  ${func}: ${typeof window[func] === 'function' ? 'Available' : 'Not Found'}\n`;
            });
            
            // Check for DOM elements
            const menuElement = document.getElementById('betterme-floating-menu');
            info += `\nFloating Menu Element: ${menuElement ? 'Found' : 'Not Found'}\n`;
            
            debugDiv.textContent = info;
        }

        // Initial checks
        setTimeout(() => {
            // Check if content script loaded
            if (typeof chrome !== 'undefined' && chrome.runtime) {
                updateStatus('extension-status', 'success', 'âœ… ×ª×•×¡×£ × ×˜×¢×Ÿ ×‘×”×¦×œ×—×”');
            } else {
                updateStatus('extension-status', 'error', 'âŒ ×ª×•×¡×£ ×œ× × ×˜×¢×Ÿ');
            }
            
            // Check for floating menu
            const menuElement = document.getElementById('betterme-floating-menu');
            if (menuElement) {
                updateStatus('menu-status', 'success', 'âœ… ×ª×¤×¨×™×˜ ×¦×£ × ×•×¦×¨');
            } else {
                updateStatus('menu-status', 'error', 'âŒ ×ª×¤×¨×™×˜ ×¦×£ ×œ× × ××¦×');
            }
            
            updateDebugInfo();
        }, 2000);

        // Check every 2 seconds
        setInterval(() => {
            updateDebugInfo();
        }, 2000);

        // Override console to capture extension logs
        const originalLog = console.log;
        const originalError = console.error;
        
        let extensionLogs = [];
        
        console.log = function(...args) {
            originalLog.apply(console, args);
            const message = args.join(' ');
            if (message.includes('ğŸ”¥') || message.includes('ğŸš€') || message.includes('ğŸ“„') || message.includes('âœ…')) {
                extensionLogs.push(`LOG: ${message}`);
                updateDebugFromLogs();
            }
        };
        
        console.error = function(...args) {
            originalError.apply(console, args);
            const message = args.join(' ');
            if (message.includes('âŒ') || message.includes('ğŸš¨')) {
                extensionLogs.push(`ERROR: ${message}`);
                updateDebugFromLogs();
            }
        };
        
        function updateDebugFromLogs() {
            const debugDiv = document.getElementById('debug-info');
            let currentInfo = debugDiv.textContent;
            
            if (extensionLogs.length > 0) {
                currentInfo += '\n\nRecent Extension Logs:\n';
                extensionLogs.slice(-5).forEach(log => {
                    currentInfo += `  ${log}\n`;
                });
            }
            
            debugDiv.textContent = currentInfo;
        }

        // Test dialog opening
        function testDialog() {
            if (typeof openSummaryDialog === 'function') {
                updateStatus('dialog-status', 'success', 'âœ… ×¤×•× ×§×¦×™×™×ª ×“×™××œ×•×’ ×–××™× ×”');
                console.log('Testing dialog function...');
                openSummaryDialog('×˜×§×¡×˜ ×‘×“×™×§×”');
            } else {
                updateStatus('dialog-status', 'error', 'âŒ ×¤×•× ×§×¦×™×™×ª ×“×™××œ×•×’ ×œ× ×–××™× ×”');
            }
        }        // Listen for text selection
        document.addEventListener('mouseup', (e) => {
            setTimeout(() => {
                const selectedText = window.getSelection().toString().trim();
                if (selectedText.length > 0) {
                    console.log('Text selected:', selectedText.substring(0, 50) + '...');
                    setTimeout(testDialog, 500);
                }
            }, 100);
        });

        // New functions for testing
        function forceTestDialog() {
            console.log('ğŸš€ Force testing dialog...');
            if (typeof openSummaryDialog === 'function') {
                console.log('âœ… openSummaryDialog function found, calling...');
                openSummaryDialog('×–×”×• ×˜×§×¡×˜ ×‘×“×™×§×” ×©× ×•×¦×¨ ×™×©×™×¨×•×ª ××”×›×¤×ª×•×¨. ×”×“×™××œ×•×’ ×××•×¨ ×œ×”×™×¤×ª×— ×¢×›×©×™×• ×•×œ×”×¦×™×’ ××ª ×”×˜×§×¡×˜ ×”×–×” ×‘×ª×•×š ×”×“×™××œ×•×’ ×”××•×“××œ×™.');
                updateStatus('dialog-status', 'success', 'âœ… ×“×™××œ×•×’ × ×§×¨× ×‘×›×•×—');
            } else {
                console.error('âŒ openSummaryDialog function not found!');
                updateStatus('dialog-status', 'error', 'âŒ ×¤×•× ×§×¦×™×” ×œ× × ××¦××”');
            }
        }

        function checkExtensionStatus() {
            console.log('ğŸ” Checking extension status...');
            updateDebugInfo();
            
            // Check floating menu
            const menu = document.getElementById('betterme-floating-menu');
            if (menu) {
                console.log('âœ… Floating menu found:', menu);
                console.log('Menu styles:', {
                    display: menu.style.display,
                    position: menu.style.position,
                    zIndex: menu.style.zIndex
                });
            }
            
            // Check for any existing dialogs
            const existingDialog = document.getElementById('betterme-summary-dialog');
            const existingOverlay = document.getElementById('betterme-summary-overlay');
            
            console.log('Existing dialog:', existingDialog);
            console.log('Existing overlay:', existingOverlay);
        }

        function clearLogs() {
            console.clear();
            extensionLogs = [];
            const debugDiv = document.getElementById('debug-info');
            debugDiv.textContent = '×œ×•×’×™× × ×•×§×•...';
            
            // Reset status
            updateStatus('extension-status', 'warning', '×‘×•×“×§ ××—×“×©...');
            updateStatus('menu-status', 'warning', '×‘×•×“×§ ××—×“×©...');
            updateStatus('dialog-status', 'warning', '×‘×•×“×§ ××—×“×©...');
            
            setTimeout(checkExtensionStatus, 500);
        }
    </script>
</body>
</html>
